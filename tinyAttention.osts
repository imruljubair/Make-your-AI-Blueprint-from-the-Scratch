{"version":"0.3.0","body":"function main(workbook: ExcelScript.Workbook) {\n  const designSheet = workbook.getWorksheet(\"Design2\");\n  const range = designSheet.getRange(\"A2:C30\");\n  const statusRange = designSheet.getRange(\"D2:D30\");\n  const values = range.getValues();\n  const allInputs = values.map(row => row[0]);\n  const allOperations = values.map(row => row[1]);\n  const allOutputs = values.map(row => row[2]);\n  \n  designSheet.getCell(0, 4).setValue(\"\");\n  statusRange.clear(ExcelScript.ClearApplyTo.all);\n\n\n  // console.log(allOutputs);\n\n  // Create or clear the \"ABH\" worksheet\n  let abhSheet = workbook.getWorksheet(\"ABH\");\n  if (abhSheet) {\n    abhSheet.getUsedRange()?.clear();\n  } else {\n    abhSheet = workbook.addWorksheet(\"ABH\");\n  }\n  let W = 25;\n  let H = 10;\n  let shapeLeftRightPos = W;\n  let shapeBottomTopPos = H;\n  let shapeWidth = 50;\n  let shapeHeight = 20;\n  abhSheet.setShowGridlines(false);\n  abhSheet.setShowHeadings(true);\n  abhSheet.getRange().getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.right);\n  abhSheet.getRange().getFormat().setColumnWidth(W);\n  abhSheet.getRange().getFormat().setRowHeight(H);\n  // abhSheet.getRange().getFormat().getFont().setName(\"Calibri\");\n  abhSheet.getRange().getFormat().getFont().setSize(8);\n  abhSheet.getRange().getFormat().getFont().setBold(false);\n  // const usedRange = abhSheet.getUsedRange();\n  // if (usedRange) {\n    \n  // }\n\n\n  // Delete all shapes from the worksheet\n  const allShapes = abhSheet.getShapes();\n  for (let shape of allShapes) {\n    shape.delete();\n  }\n\n  // Now you're free to draw new shapes!\n\n  // âœ… Cursor stored as an object so we can mutate it anywhere\n  let cursor = { row: 1, col: 2 , range};\n  let blockStartCursor = { row: 1, col: 2, range };\n  let blockEndCursor = { row: 1, col: 2, range };\n\n  let T = 0;\n  let d = 0;\n  let hasInput: boolean = false;\n  let namedVariable = \"X\";\n  let output_var_name = \"X\";\n  let dim_var_name = \"d\";\n  let dim_value = 1;\n  let temprange: ExcelScript.Range;\n  let currentShape: ExcelScript.Shape;\n  let prevShape: ExcelScript.Shape;\n\n\n  let params: { [key: string]: [string, number] } = { };  // Regex to match \", dim d=3\"\n  const regex = /^(\\w+),?\\s*dim\\s+(\\w+)\\s*=\\s*(\\d+)/i;\n\n  for (let i = 0; i < allOutputs.length; i++) {\n    const cellValue = String(allOutputs[i]).trim();\n    // console.log(cellValue);\n    const match = cellValue.match(regex);\n    if (match) {\n      const outVarName = match[1];\n      const key = match[2];\n      const num = Number(match[3]);\n      params[outVarName] = [key, num];\n    }\n    else{\n      const simpleMatch = cellValue.match(/^(\\w+)$/);\n      if (simpleMatch) {\n        const outVarName = simpleMatch[1];\n        // Only add if not already present\n        if (!(outVarName in params)) {\n          params[outVarName] = [\"\", 1];\n        }\n      }\n    }\n    \n  }\n\n  // console.log(params);\n  let ops_var_temp = \"\";\n  \n\n\n  for (let i = 0; i < values.length; i++)\n  {\n//   //   // Process the first row\n    // cursor.row += 1;\n    \n    \n    blockStartCursor = cursor;\n\n    const row = values[i];\n    const input = row[0] as string;\n    const operation = row[1] as string;\n    const output = row[2] as string;\n    let input_var_name= \"\";\n    let input_string = \"\";\n    \n    if (input==\"\"){\n      // designSheet.getCell(4, 4).setValue(\"ðŸ‘‡ Check ABH sheet!\");\n      fullCompleteMessage(designSheet,0,4);\n        break;\n    }\n    \n    \n    if(input){\n\n      const input_token_match = input.match(/^([^=]+)=([^=]+)$/);\n      if(input_token_match){\n        const xd = 1;\n        input_var_name = input_token_match[1].trim();\n        input_string = input_token_match[2].trim();\n        T = input_string.length;\n        namedVariable = input_var_name;\n        cursor = drawXwithText(abhSheet, input_var_name, input_string, cursor.row, cursor.col, xd, T);\n\n        // cursor = ABCto123(abhSheet, changeTitle2(output_var_name, operation, input_var_name), cursor.row, cursor.col, cursor.range, 1, T);\n        updateName(workbook, cursor, output_var_name);\n        let range_: ExcelScript.Range;\n        range_ = cursor.range;\n        let tcode = getCode(range_, input_var_name, output_var_name, cursor.row, cursor.col, xd, T);\n        const cc = cursor.col+ (T+2);\n        const cr = cursor.row - (xd+1);\n        abhSheet.getCell(cr, cc).setValue(tcode);\n        abhSheet.getCell(cr, cc).getFormat().getFont().setName(\"Courier New\");\n        abhSheet.getCell(cr, cc).getFormat().getFont().setColor(\"gray\");\n        abhSheet.getCell(cr, cc).getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.left);\n        // abhSheet.addComment(\"A1\", \"Hi\");\n        // console.log(input_var_name);\n\n\n      }\n      else{\n        input_var_name = input;\n      }\n\n    }\n\n    const range = drawBlockBorder(i, abhSheet, input_var_name, operation, cursor.row, cursor.col);\n    cursor.row += 2;\n\n    if(output){\n      const output_match = output.match(/^(\\w+),\\s*dim\\s+(\\w+)\\s*=\\s*(\\d+)$/i);\n      if (output_match) {\n        output_var_name = output_match[1];\n        dim_var_name = output_match[2];\n        dim_value = Number(output_match[3]);\n      \n        namedVariable = output_var_name;\n        // console.log(output_var_name);\n        // \n      }\n      else{\n        output_var_name = output;\n        namedVariable = output_var_name;\n      }\n      let d1 = params[output_var_name][1];\n      \n      // params[dim_var_name] = d;\n      \n\n          if (operation == \"Embed\"){\n            const commCell = abhSheet.getCell(cursor.row-2, cursor.col-1);\n            abhSheet.addComment(commCell, \"--\" ) ;\n\n            cursor = drawMatrix(abhSheet, changeTitle2(output_var_name ,operation, input_var_name) , cursor.row, cursor.col, d1, T, \"random\");  \n            updateName(workbook, cursor, output_var_name);\n\n            let cr = cursor.row - (d1 + 1);\n            let cc = cursor.col + (T + 2);\n            let codeString = `${output_var_name} = nn.Embedding((26, ${d1})(${input_var_name})`;\n\n            abhSheet.getCell(cr, cc).setValue(codeString);\n            abhSheet.getCell(cr, cc).getFormat().getFont().setName(\"Courier New\");\n            abhSheet.getCell(cr, cc).getFormat().getFont().setColor(\"gray\");\n            abhSheet.getCell(cr, cc).getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.left);\n            // write1DnumParams(abhSheet, dim_var_name, d, cursor, d, T);\n            // console.log(ops_var_temp);\n            // prevShape = currentShape;\n          }\n\n          else if(operation == \"PE+\"){\n\n            const commCell = abhSheet.getCell(cursor.row - 2, cursor.col - 1);\n            abhSheet.addComment(commCell, \"Positional encoding is a technique used in Transformer models to give each token information about its position in a sequence, since Transformers do not inherently process data in order like RNNs do.It adds or concatenates a position - dependent vector to each tokenâ€™s embedding, allowing the model to capture the notion of word order.\");\n\n            cursor = drawMatrix(abhSheet, \"Positions\", cursor.row, cursor.col, 1, T, \"seq\");\n            cursor = drawMatrix(abhSheet, \"PE\", cursor.row, cursor.col, d1, T, \"random\");\n            updateName(workbook, cursor, \"PE\");\n            const range1 = workbook.getNamedItem(output_var_name).getRange();\n            let range2: ExcelScript.Range;\n            range2 = cursor.range;\n            cursor = add2Matrices(abhSheet, range1, range2, changeTitle2(output_var_name,operation, input_var_name) , cursor.row, cursor.col, d1, T);\n            updateName(workbook, cursor, output_var_name);\n            \n            \n          }\n\n          else if (operation == \"Layer-Norm\") {\n            const commCell = abhSheet.getCell(cursor.row - 2, cursor.col - 1);\n            abhSheet.addComment(commCell, \"Layer normalization is a technique that stabilizes and speeds up training by normalizing the features within each layer for every input sample. It works by making the activations in a layer have zero mean and unit variance across features(not across the batch).\");\n\n            const r = workbook.getNamedItem(input_var_name).getRange();\n            const rows = r.getRowCount();\n            // const cola = r.getColumnCount();\n            cursor = LayerNorm(abhSheet, changeTitle2(output_var_name, operation, input_var_name), cursor.row, cursor.col, r, rows, T);\n            updateName(workbook, cursor, output_var_name);\n          }\n\n          else if(operation==\"ReLU\"){\n            const commCell = abhSheet.getCell(cursor.row - 2, cursor.col - 1);\n            abhSheet.addComment(commCell, \"ReLU (Rectified Linear Unit) is an activation function that outputs the input directly if it is positive; otherwise, it outputs zero. It introduces non-linearity and helps neural networks learn complex patterns efficiently.\");\n\n            const r = workbook.getNamedItem(input_var_name).getRange();\n            const rows = r.getRowCount();\n            // const cola = r.getColumnCount();\n            // const cell = abhSheet.getCell(cursor.row, cursor.col);\n         \n            // \n            cursor = ReLU(abhSheet, changeTitle2(output_var_name,operation, input_var_name) , cursor.row, cursor.col, r, rows, T);\n            updateName(workbook, cursor, output_var_name);\n          }\n\n          else if(operation==\"L1-Normalize\"){\n            const r = workbook.getNamedItem(input_var_name).getRange();\n            const rows = r.getRowCount();\n            // const cola = r.getColumnCount();\n            cursor = L1Normalization(abhSheet, changeTitle2(output_var_name, operation, input_var_name), cursor.row, cursor.col, r, rows, T);\n            updateName(workbook, cursor, output_var_name); \n          }\n\n          else if (operation == \"L2-Normalize\") {\n            const r = workbook.getNamedItem(input_var_name).getRange();\n            const rows = r.getRowCount();\n            // const cola = r.getColumnCount();\n            cursor = L2Normalization(abhSheet, changeTitle2(output_var_name, operation, input_var_name), cursor.row, cursor.col, r, rows, T);\n            updateName(workbook, cursor, output_var_name);\n          }\n\n          else if (operation == \"Softmax\") {\n            const commCell = abhSheet.getCell(cursor.row - 2, cursor.col - 1);\n            abhSheet.addComment(commCell, \"Softmax is a function that converts a vector of real numbers into a probability distribution, where each value lies between 0 and 1 and all values sum to 1. It highlights the largest values while suppressing smaller ones, making it useful for classification tasks.\");\n\n            const r = workbook.getNamedItem(input_var_name).getRange();\n            const rows = r.getRowCount();\n            // const cola = r.getColumnCount();\n            // console.log(changeTitle2(output_var_name, operation, input_var_name));\n            cursor = softmax(abhSheet, changeTitle2(output_var_name, operation, input_var_name), cursor.row, cursor.col, r, rows, T);\n            updateName(workbook, cursor, output_var_name);\n          }\n\n          else if (operation.includes(\"*\") && input_var_name in params){\n            const output_match = output.match(/^(\\w+),\\s*dim\\s+(\\w+)\\s*=\\s*(\\d+)$/i);\n            \n\n            // console.log(\"-->\"+input_var_name);\n            // if(input_var_name in params){\n            let range1 = workbook.getNamedItem(input_var_name).getRange();\n            let d1 = params[input_var_name][1];\n            // }\n            let d2 = 0;\n          //   let d_ = 0;\n            if (output_match && !(operation.replace(/\\*/g, \"\") in params)) {\n              output_var_name = output_match[1];\n              dim_var_name = output_match[2];\n              dim_value = Number(output_match[3]);\n              namedVariable = output_var_name;\n              d2 = params[output_var_name][1] ;\n              cursor = drawMatrix(abhSheet, operation.replace(/\\*/g, \"\"), cursor.row, cursor.col, d2, d1, \"random\");\n              updateName(workbook, cursor, operation.replace(/\\*/g, \"\"));\n              cursor.row = cursor.row - (d2 + 2);\n              cursor.col = cursor.col + (d1 + 1);\n              const range2 = workbook.getNamedItem(operation.replace(/\\*/g, \"\")).getRange();\n              cursor = multMatricesWithRand(abhSheet, range2, range1, d1, d2, T, changeTitle2(output_var_name,operation, input_var_name), cursor.row, cursor.col);\n              cursor.col = cursor.col - (d1 + 1);\n              updateName(workbook, cursor, output_var_name);\n            }\n\n            const ops_match = operation.match(/\\b([A-Za-z])\\^T\\*/);\n            if(ops_match){\n              const ops_var = ops_match[1];\n              if (ops_var in params){\n                d2 = params[ops_var][1];\n                const r = workbook.getNamedItem(ops_var).getRange();\n                cursor = transposeMatrix(abhSheet, r, operation.replace(/\\*/g, \"\"), ops_var, cursor.row, cursor.col, T, d2);\n                updateName(workbook, cursor, operation.replace(/[^A-Za-z0-9_]/g, \"\"));\n                cursor.row = cursor.row - (T+2);\n                cursor.col = cursor.col + (d1 + 1);\n                const range2 = workbook.getNamedItem(operation.replace(/[^A-Za-z0-9_]/g, \"\")).getRange();\n                cursor = multMatricesWithRand(abhSheet, range2, range1, T, T, T, changeTitle2(output_var_name,operation, input_var_name), cursor.row, cursor.col);\n                cursor.col = cursor.col - (d1 + 1);\n                updateName(workbook, cursor, output_var_name);\n                \n              }\n            }\n\n            const ops_match2 = operation.match(/^(\\w+)\\*$/ );\n            if (ops_match2) {\n              // console.log(input_var_name);\n\n              const ops_var = ops_match2[1];\n              if (ops_var in params) {\n                d2 = params[ops_var][1];\n                const r = workbook.getNamedItem(ops_var).getRange();\n                // cursor = transposeMatrix(abhSheet, r, operation.replace(/\\*/g, \"\"), ops_var, cursor.row, cursor.col, T, d2);\n                // const range1 = workbook.getNamedItem(operation.replace(/[^A-Za-z0-9_]/g, \"\")).getRange();\n                cursor = drawMatrix(abhSheet, operation.replace(/[^A-Za-z0-9_]/g, \"\"), cursor.row, cursor.col, d2, T, \"other\", r);\n                updateName(workbook, cursor, operation.replace(/[^A-Za-z0-9_]/g, \"\"));\n                cursor.row = cursor.row - (d2 + 2);\n                cursor.col = cursor.col + (T + 1);\n                const range2 = workbook.getNamedItem(operation.replace(/[^A-Za-z0-9_]/g, \"\")).getRange();\n                cursor = multMatricesWithRand(abhSheet, range2, range1, T, d2, T, changeTitle2(output_var_name,operation, input_var_name), cursor.row, cursor.col);\n                cursor.col = cursor.col - (T + 1);\n                updateName(workbook, cursor, output_var_name);\n\n              }\n            }\n\n\n            \n\n          }\n        \n      // console.log(blockStartCursor.col + \", \" + blockEndCursor.col);\n\n    }\n\n    doneMessage(i, designSheet, 3);\n    blockEndCursor = cursor;\n    // console.log(blockStartCursor.row + \", \" + blockEndCursor.row);\n\n\n    \n  }\n  // console.log(params)\n\n}\n\nfunction moveCursor(cursor: { row: number; col: number }, r: number, c: number) {\n  cursor.row += r;\n  cursor.col += c;\n}\n\nfunction updateName(\n  workbook: ExcelScript.Workbook,\n  cursor: { row: number; col: number; range: ExcelScript.Range },\n  namedVariable: string\n){\n    \n    let temprange: ExcelScript.Range; \n    temprange = cursor.range;\n    let allNames = workbook.getNames();\n\n    allNames.forEach(n => {\n      if (n.getName() === namedVariable) {\n        n.delete();\n      }\n    });\n\n    workbook.addNamedItem(namedVariable, temprange);\n\n}\n\n/**\n * Converts numeric indices to Excel A1 notation\n */\nfunction convertToA1(row: number, column: number): string {\n  let columnLabel = \"\";\n  column = column + 1;\n  row = row + 1;\n  while (column > 0) {\n    column--;\n    columnLabel = String.fromCharCode(65 + (column % 26)) + columnLabel;\n    column = Math.floor(column / 26);\n  }\n  return `${columnLabel}${row}`;\n}\n\n/**\n * Formats and colors a rectangular range\n */\nfunction doFormatting(\n  sheet: ExcelScript.Worksheet,\n  cursorrow: number,\n  cursorcol: number,\n  number_of_rows: number,\n  number_of_cols: number,\n  color: string,\n) {\n  const range = sheet.getRange(\n    convertToA1(cursorrow, cursorcol) + \":\" + convertToA1(cursorrow + number_of_rows - 1, cursorcol + number_of_cols - 1)\n  );\n\n  const fmt = range.getFormat();\n  const borders = [\n    ExcelScript.BorderIndex.edgeTop,\n    ExcelScript.BorderIndex.edgeBottom,\n    ExcelScript.BorderIndex.edgeLeft,\n    ExcelScript.BorderIndex.edgeRight,\n    ExcelScript.BorderIndex.insideVertical,\n    ExcelScript.BorderIndex.insideHorizontal,\n  ];\n\n  for (let b of borders) {\n    fmt.getRangeBorder(b).setStyle(ExcelScript.BorderLineStyle.continuous);\n    // fmt.getRangeBorder(b).setWeight(2);\n    fmt.getRangeBorder(b).setColor(\"gray\");\n  }\n\n  fmt.getFill().setColor(color);\n\n  return range;\n}\n\n\nfunction embedViaLookUp(\n  tokens: string,\n  sheet: ExcelScript.Worksheet,\n  inputRange: ExcelScript.Range\n){\n  const dim = 3; // number of elements per embedding\n  const lookup = lookUp();\n  const embedMat: number[][] = Array.from({ length: dim }, () => []);\n\n  for (const token of tokens) {\n    const vec = lookup[token];\n    if (vec) {\n      for (let i = 0; i < dim; i++) embedMat[i].push(vec[i]);\n    } else {\n      // handle unknown token\n      for (let i = 0; i < dim; i++) embedMat[i].push(0);\n    }\n  }\n\n  return embedMat;\n}\n\n/**\n * Draws a random matrix at the current cursor position\n */\nfunction drawMatrix(\n  sheet: ExcelScript.Worksheet,\n  header: string,\n  cursorrow: number,\n  cursorcol: number,\n  number_of_rows: number,\n  number_of_cols: number,\n  randorseq: string,\n  in_range?: ExcelScript.Range\n) {\n  \n  sheet.getCell(cursorrow, cursorcol).setValue(header);\n  sheet.getCell(cursorrow, cursorcol).getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.left);\n  cursorrow+=1;\n  let formula_ = ``;\n  let color = \"#daf2d1\";\n  if (randorseq==\"random\"){\n    formula_ = `=RANDARRAY(${number_of_rows}, ${number_of_cols}, -1, 1)`\n    color = \"yellow\";\n  }\n  else if(randorseq==\"seq\"){\n    formula_ = `=SEQUENCE(${number_of_rows}, ${number_of_cols}, 0)`\n    color = \"white\";\n  }\n  else if(randorseq==\"other\"){\n    formula_ = `=${in_range.getAddress()}`;\n  }\n  \n  sheet\n    .getCell(cursorrow, cursorcol)\n    .setFormula(formula_);\n\n  const range = doFormatting(sheet, cursorrow, cursorcol, number_of_rows, number_of_cols, color);\n  cursorrow += number_of_rows+1;\n\n  return {row: cursorrow, col: cursorcol, range};\n\n}\n\nfunction ReLU(sheet: ExcelScript.Worksheet,\n  header: string,\n  cursorrow: number,\n  cursorcol: number,\n  in_range: ExcelScript.Range,\n  number_of_rows: number,\n  number_of_cols: number,\n){\n\n  sheet.getCell(cursorrow, cursorcol).setValue(header);\n  sheet.getCell(cursorrow, cursorcol).getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.left);\n\n  cursorrow += 1;\n  let formula_ = ``;\n  formula_ = `=IF(${in_range.getAddress()}>0, ${in_range.getAddress()}, 0)`;\n  sheet\n    .getCell(cursorrow, cursorcol)\n    .setFormula(formula_);\n\n  const range = doFormatting(sheet, cursorrow, cursorcol, number_of_rows, number_of_cols, \"#d5a6bd\");\n  cursorrow += number_of_rows + 1;\n\n  return { row: cursorrow, col: cursorcol, range };\n\n}\n\nfunction ABCto123(sheet: ExcelScript.Worksheet,\n  header: string,\n  cursorrow: number,\n  cursorcol: number,\n  in_range: ExcelScript.Range,\n  number_of_rows: number,\n  number_of_cols: number,\n) {\n\n  // sheet.getCell(cursorrow, cursorcol).setValue(header);\n  sheet.getCell(cursorrow, cursorcol).getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.left);\n\n  // cursorrow += 1;\n  let formula_ = ``;\n  formula_ = `=CODE(LOWER(${in_range.getAddress()}))- CODE(\"a\")`;\n  sheet\n    .getCell(cursorrow, cursorcol)\n    .setFormula(formula_);\n\n  const range = doFormatting(sheet, cursorrow, cursorcol, number_of_rows, number_of_cols, \"#d5a6bd\");\n  cursorrow += number_of_rows + 1;\n\n  return { row: cursorrow, col: cursorcol, range };\n\n}\n\nfunction LayerNorm(sheet: ExcelScript.Worksheet,\n  header: string,\n  cursorrow: number,\n  cursorcol: number,\n  in_range: ExcelScript.Range,\n  number_of_rows: number,\n  number_of_cols: number,\n) {\n\n  sheet.getCell(cursorrow, cursorcol).setValue(\"Mean\");\n  sheet.getCell(cursorrow, cursorcol).getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.left);\n\n  cursorrow += 1;\n  let formula_ = ``;\n  formula_ = `=BYCOL(${in_range.getAddress()}, LAMBDA(col, AVERAGE(col)))`;\n  sheet\n    .getCell(cursorrow, cursorcol)\n    .setFormula(formula_);\n\n  const range1 = doFormatting(sheet, cursorrow, cursorcol, 1, number_of_cols, \"#88f2c1\");\n  cursorrow += 2;\n\n  sheet.getCell(cursorrow, cursorcol).setValue(\"Std\");\n  sheet.getCell(cursorrow, cursorcol).getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.left);\n\n  cursorrow += 1;\n  formula_ = `=BYCOL(${in_range.getAddress()}, LAMBDA(col, STDEV.S(col)))`;\n  sheet\n    .getCell(cursorrow, cursorcol)\n    .setFormula(formula_);\n\n  const range2 = doFormatting(sheet, cursorrow, cursorcol, 1, number_of_cols, \"#88f2c1\");\n  cursorrow += 2;\n\n\n\n  sheet.getCell(cursorrow, cursorcol).setValue(header);\n  sheet.getCell(cursorrow, cursorcol).getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.left);\n  cursorrow += 1;\n  // console.log(range.getAddress());\n  // let formula_ = ``;\n  formula_ = `=(${in_range.getAddress()} - ${range1.getAddress()})/(${range2.getAddress()} - 0.00000001)`;\n  sheet\n    .getCell(cursorrow, cursorcol)\n    .setFormula(formula_);\n\n  const range = doFormatting(sheet, cursorrow, cursorcol, number_of_rows, number_of_cols, \"#88f2c1\");\n  cursorrow += number_of_rows + 1;\n\n  return { row: cursorrow, col: cursorcol, range };\n\n}\n\nfunction L1Normalization(sheet: ExcelScript.Worksheet,\n  header: string,\n  cursorrow: number,\n  cursorcol: number,\n  in_range: ExcelScript.Range,\n  number_of_rows: number,\n  number_of_cols: number,\n) {\n\n  sheet.getCell(cursorrow, cursorcol).setValue(\"L1\");\n  sheet.getCell(cursorrow, cursorcol).getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.left);\n\n  cursorrow += 1;\n  let formula_ = ``;\n  formula_ = `=BYCOL(${in_range.getAddress()}, LAMBDA(col, SUMPRODUCT(ABS(col))))`;\n  sheet\n    .getCell(cursorrow, cursorcol)\n    .setFormula(formula_);\n\n  const range_ = doFormatting(sheet, cursorrow, cursorcol, 1, number_of_cols, \"#fff2cc\");\n  cursorrow += 2;\n\n\n  sheet.getCell(cursorrow, cursorcol).setValue(header);\n  sheet.getCell(cursorrow, cursorcol).getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.left);\n  cursorrow += 1;\n  // console.log(range.getAddress());\n  // let formula_ = ``;\n  formula_ = `=${in_range.getAddress()}/IF(${range_.getAddress()}=0,1, ${range_.getAddress()})`;\n  sheet\n    .getCell(cursorrow, cursorcol)\n    .setFormula(formula_);\n\n  const range = doFormatting(sheet, cursorrow, cursorcol, number_of_rows, number_of_cols, \"#fff2cc\");\n  cursorrow += number_of_rows + 1;\n\n  return { row: cursorrow, col: cursorcol, range };\n\n}\n\n\nfunction L2Normalization(sheet: ExcelScript.Worksheet,\n  header: string,\n  cursorrow: number,\n  cursorcol: number,\n  in_range: ExcelScript.Range,\n  number_of_rows: number,\n  number_of_cols: number,\n) {\n\n  sheet.getCell(cursorrow, cursorcol).setValue(\"L2\");\n  sheet.getCell(cursorrow, cursorcol).getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.left);\n\n  cursorrow += 1;\n  let formula_ = ``;\n  formula_ = `=BYCOL(${in_range.getAddress()}, LAMBDA(col, SQRT(SUM(col^2))))`;\n  sheet\n    .getCell(cursorrow, cursorcol)\n    .setFormula(formula_);\n\n  const range_ = doFormatting(sheet, cursorrow, cursorcol, 1, number_of_cols, \"#ffa7cc\");\n  cursorrow += 2;\n\n\n  sheet.getCell(cursorrow, cursorcol).setValue(header);\n  sheet.getCell(cursorrow, cursorcol).getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.left);\n  cursorrow += 1;\n  // console.log(range.getAddress());\n  // let formula_ = ``;\n  formula_ = `=${in_range.getAddress()}/IF(${range_.getAddress()}=0,1, ${range_.getAddress()})`;\n  sheet\n    .getCell(cursorrow, cursorcol)\n    .setFormula(formula_);\n\n  const range = doFormatting(sheet, cursorrow, cursorcol, number_of_rows, number_of_cols, \"#ffa7cc\");\n  cursorrow += number_of_rows + 1;\n\n  return { row: cursorrow, col: cursorcol, range };\n\n}\n\n\nfunction softmax(sheet: ExcelScript.Worksheet,\n  header: string,\n  cursorrow: number,\n  cursorcol: number,\n  in_range: ExcelScript.Range,\n  number_of_rows: number,\n  number_of_cols: number,\n) {\n\n  sheet.getCell(cursorrow, cursorcol).setValue(\"Exp\");\n  sheet.getCell(cursorrow, cursorcol).getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.left);\n\n  cursorrow += 1;\n  let formula_ = ``;\n  formula_ = `=EXP(${in_range.getAddress()})`;\n  sheet\n    .getCell(cursorrow, cursorcol)\n    .setFormula(formula_);\n\n  const range1 = doFormatting(sheet, cursorrow, cursorcol, number_of_rows, number_of_cols, \"#fff2cc\");\n  cursorrow += number_of_rows + 1;\n\n  sheet.getCell(cursorrow, cursorcol).setValue(\"Sum (Exp)\");\n  sheet.getCell(cursorrow, cursorcol).getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.left);\n\n  cursorrow += 1;\n  // let formula_ = ``;\n  formula_ = `=BYCOL(${in_range.getAddress()}, LAMBDA(col, SUM(EXP(col))))`;\n  sheet\n    .getCell(cursorrow, cursorcol)\n    .setFormula(formula_);\n\n  const range2 = doFormatting(sheet, cursorrow, cursorcol, 1, number_of_cols, \"#fff2cc\");\n  cursorrow  += 2;\n\n\n  sheet.getCell(cursorrow, cursorcol).setValue(header);\n  sheet.getCell(cursorrow, cursorcol).getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.left);\n  // let formula_ = ``;\n  cursorrow += 1;\n  formula_ = `=${range1.getAddress()}/${range2.getAddress()}`;\n  sheet\n    .getCell(cursorrow, cursorcol)\n    .setFormula(formula_);\n\n  const range = doFormatting(sheet, cursorrow, cursorcol, number_of_rows, number_of_cols, \"#fff2cc\");\n  cursorrow += number_of_rows + 1;\n\n\n\n\n  return { row: cursorrow, col: cursorcol, range };\n\n}\n\n\n\nfunction drawXwithText(\n  sheet: ExcelScript.Worksheet,\n  header: string,\n  extractedString: string,\n  cursorrow: number,\n  cursorcol: number,\n  number_of_rows: number,\n  number_of_cols: number\n){\n  sheet.getCell(cursorrow, cursorcol).setValue(header);\n  sheet.getCell(cursorrow, cursorcol).getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.left);\n\n  cursorrow += 1;\n\n  const charCount = extractedString.length;\n\n  for (let i = 0; i < charCount; i++) {\n    const cell = sheet.getCell(cursorrow, cursorcol + i); // zero-indexed\n    cell.setValue(extractedString[i]);\n  }\n  const range2 = doFormatting(sheet, cursorrow, cursorcol, number_of_rows, number_of_cols, \"#f6b26b\");\n  cursorrow += number_of_rows+1;\n\n  sheet.getCell(cursorrow, cursorcol).setValue(\"Token ID\")\n  sheet.getCell(cursorrow, cursorcol).getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.left);\n  cursorrow += 1;\n  const formula_ = `=CODE(LOWER(${range2.getAddress()}))- CODE(\"a\")`;\n  sheet\n    .getCell(cursorrow, cursorcol)\n    .setFormula(formula_);\n  const range = doFormatting(sheet, cursorrow, cursorcol, number_of_rows, number_of_cols, \"white\");\n  cursorrow += number_of_rows + 1;\n  return { row: cursorrow, col: cursorcol, range }\n}\n\nfunction transposeMatrix(\n  sheet: ExcelScript.Worksheet,\n  in_range: ExcelScript.Range,\n  header: string,\n  var_name: string,\n  cursorrow: number,\n  cursorcol: number,\n  number_of_rows: number,\n  number_of_cols: number\n){\n  sheet.getCell(cursorrow, cursorcol).setValue(header);\n  sheet.getCell(cursorrow, cursorcol).getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.left);\n\n  cursorrow += 1;\n  const formula_ = `=TRANSPOSE(${in_range.getAddress()})`;\n  sheet\n    .getCell(cursorrow, cursorcol)\n    .setFormula(formula_);\n  const range = doFormatting(sheet, cursorrow, cursorcol, number_of_rows, number_of_cols, \"#daf2d1\");\n  cursorrow += number_of_rows + 1;\n\n  return { row: cursorrow, col: cursorcol, range };\n}\n\nfunction add2Matrices(\n  sheet: ExcelScript.Worksheet,\n  range1: ExcelScript.Range,\n  range2: ExcelScript.Range,\n  header: string,\n  cursorrow: number,\n  cursorcol: number,\n  number_of_rows: number,\n  number_of_cols: number\n){\n  sheet.getCell(cursorrow, cursorcol).setValue(header);\n  sheet.getCell(cursorrow, cursorcol).getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.left);\n\n  cursorrow+=1;\n  const formula_ = `=${range1.getAddress()}+${range2.getAddress()}`;\n  sheet\n    .getCell(cursorrow, cursorcol)\n    .setFormula(formula_);\n  const range = doFormatting(sheet, cursorrow, cursorcol, number_of_rows, number_of_cols, \"#cfe2f3\");\n  cursorrow += number_of_rows+1;\n\n  return {row: cursorrow, col: cursorcol, range};\n}\n\nfunction multMatricesWithRand(\n  sheet: ExcelScript.Worksheet,\n  range1: ExcelScript.Range,\n  range2: ExcelScript.Range,\n  indim: number,\n  outdim: number,\n  outcols: number,\n  header: string,\n  cursorrow: number,\n  cursorcol: number,\n){\n  const number_of_rows = outdim;\n  const number_of_cols = indim;\n\n  sheet.getCell(cursorrow, cursorcol).setValue(header);\n  sheet.getCell(cursorrow, cursorcol).getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.left);\n  \n  cursorrow += 1;\n  const formula_ = `=MMULT(${range1.getAddress()},${range2.getAddress()})`;\n  sheet\n    .getCell(cursorrow, cursorcol)\n    .setFormula(formula_);\n  const range = doFormatting(sheet, cursorrow, cursorcol, number_of_rows, outcols, \"#DABBFC\");\n  cursorrow += number_of_rows + 1;\n\n  return { row: cursorrow, col: cursorcol, range };\n}\n\n\nfunction mult2Matrices(\n  sheet: ExcelScript.Worksheet,\n  range1: ExcelScript.Range,\n  range2: ExcelScript.Range,\n  indim: number,\n  outdim: number,\n  outcols: number,\n  header: string,\n  cursorrow: number,\n  cursorcol: number,\n){\n  const number_of_rows = outdim;\n  const number_of_cols = indim;\n\n  sheet.getCell(cursorrow, cursorcol).setValue(header);\n  sheet.getCell(cursorrow, cursorcol).getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.left);\n\n  cursorrow += 1;\n  const formula_ = `=MMULT(${range1.getAddress()},${range2.getAddress()})`;\n  sheet\n    .getCell(cursorrow, cursorcol)\n    .setFormula(formula_);\n  const range = doFormatting(sheet, cursorrow, cursorcol, number_of_rows, outcols, \"#DABBFC\");\n  cursorrow += number_of_rows + 1;\n\n  return { row: cursorrow, col: cursorcol, range };\n}\n\nfunction changeTitle(\n  ops_string: string,\n  var_string: string\n){\n    let out_string = \"\";\n    out_string = ops_string+\"(\"+var_string+\")\";\n    return out_string;\n}\n\nfunction changeTitle2(\n  out_var: string,\n  ops_string: string,\n  var_string: string\n) {\n  let out_string = \"\";\n  out_string = out_var+ \" = \" +ops_string + \" (\" + var_string + \")\";\n  return out_string;\n}\n\nfunction drawShape(\n  sheet: ExcelScript.Worksheet,\n  text: string,\n  posW: number,\n  posH: number,\n  shapeW: number,\n  shapeH: number\n\n){\n  const shape = sheet.addGeometricShape(ExcelScript.GeometricShapeType.roundRectangle);\n  shape.setName(\"in\");\n  shape.setLeft(posW);\n  shape.setTop(posH);\n  shape.setWidth(shapeW);\n  shape.setHeight(shapeH);\n  shape.getFill().setSolidColor(\"lightblue\");\n  shape.getTextFrame().getTextRange().setText(text);\n  shape.getTextFrame().getTextRange().getFont().setColor(\"black\")\n  shape.getTextFrame().getTextRange().getFont().setSize(8);\n  shape.getTextFrame().setHorizontalAlignment(ExcelScript.ShapeTextHorizontalAlignment.center);\n  shape.getTextFrame().setVerticalAlignment(ExcelScript.ShapeTextVerticalAlignment.middle);\n\n  shape.getLineFormat().setWeight(0);\n}\n\n\nfunction drawObject(\n  sheet: ExcelScript.Worksheet,\n  text: string,\n  posW: number,\n  posH: number,\n  shapeW: number,\n  shapeH: number,\n  previousShape?: ExcelScript.Shape,\n){\n\n  const shape = sheet.addGeometricShape(ExcelScript.GeometricShapeType.roundRectangle);\n  // shape.setName(\"in\");\n  shape.setLeft(posW);\n  shape.setTop(posH);\n  shape.setWidth(shapeW);\n  shape.setHeight(shapeH);\n  shape.getFill().setSolidColor(\"lightblue\");\n  shape.getTextFrame().getTextRange().setText(text);\n  shape.getTextFrame().getTextRange().getFont().setColor(\"black\")\n  shape.getTextFrame().getTextRange().getFont().setSize(8);\n  shape.getTextFrame().setHorizontalAlignment(ExcelScript.ShapeTextHorizontalAlignment.center);\n  shape.getTextFrame().setVerticalAlignment(ExcelScript.ShapeTextVerticalAlignment.middle);\n  \n  // if (previousShape){\n  //   // Arrow from Start to Input\n  //   const arrow1 = sheet.addLine(0, 0, 10, 10, ExcelScript.ConnectorType.curve);\n\n  //   arrow1.getLineFormat().setColor(\"black\");\n\n  //   arrow1.getLine().setBeginArrowheadStyle(ExcelScript.ArrowheadStyle.oval)\n  //   arrow1.getLine().connectBeginShape(previousShape, 2);  // Left side\n\n  //   arrow1.getLine().setEndArrowheadStyle(ExcelScript.ArrowheadStyle.stealth)\n  //   arrow1.getLine().connectEndShape(shape, 1); // Right sidend\n  // }\n\n  return shape;\n}\n\nfunction shapeConnector(\n  sheet: ExcelScript.Worksheet,\n  shape0name: string,\n  shape1name: string,\n){\n  const allShapes = sheet.getShapes();\n  const previousShape = allShapes.find(s => s.getName() === shape0name);\n  const shape = allShapes.find(s => s.getName() === shape1name);\n\n    // Arrow from Start to Input\n    const arrow1 = sheet.addLine(0, 0, 10, 10, ExcelScript.ConnectorType.curve);\n\n    arrow1.getLineFormat().setColor(\"black\");\n    arrow1.getLineFormat().setWeight(1);\n    arrow1.getLineFormat().setDashStyle(ExcelScript.ShapeLineDashStyle.systemDot);\n\n    arrow1.getLine().setBeginArrowheadStyle(ExcelScript.ArrowheadStyle.oval)\n    arrow1.getLine().connectBeginShape(previousShape, 3);  // Left side\n\n    arrow1.getLine().setEndArrowheadStyle(ExcelScript.ArrowheadStyle.stealth)\n    arrow1.getLine().connectEndShape(shape, 1); // Right sidend\n\n\n}\n\n/**\n * Formats and colors a rectangular range\n */\nfunction drawBlockBorder(\n  blockID: number,\n  sheet: ExcelScript.Worksheet,\n  input_var_name: string,\n  blockheader: string,\n  cursorrow: number,\n  cursorcol: number\n) {\n  // cursorcol-=1;\n  const number_of_cols = 20;\n  const number_of_rows = 1;\n  sheet.getCell(cursorrow, cursorcol).setValue(\"# \"+(blockID+1));\n  sheet.getCell(cursorrow, cursorcol).getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.left);\n  sheet.getCell(cursorrow, cursorcol + 1).setValue(\" \"+blockheader);\n  sheet.getCell(cursorrow, cursorcol+1).getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.left);\n  sheet.getCell(cursorrow, cursorcol+1).getFormat().getFont().setColor(\"gray\");\n  sheet.getCell(cursorrow, cursorcol + 1).getFormat().getFont().setItalic(true);\n\n\n  sheet.getCell(cursorrow, cursorcol).getFormat().getFont().setSize(8);\n  sheet.getCell(cursorrow, cursorcol).getFormat().getFont().setColor(\"white\");\n  sheet.getCell(cursorrow, cursorcol).getFormat().getFill().setColor(\"black\");\n\n\n  // const range2 = sheet.getRangeByIndexes(cursorrow,cursorcol+1, 1,1);\n  // const valueCell = sheet.getCell(cursorrow, cursorcol + 1); // A1\n  // // sheet.getCell(cursorrow, cursorcol + 1).setValue(\"show\");\n  // valueCell.setValue(\"show\")\n  // const options = [\"show\", \"hide\"];\n\n  // // Apply data validation\n  // const validation =valueCell.getDataValidation();\n  // validation.setRule({\n  //   list: {\n  //     inCellDropDown: true,\n  //     source: options.join(\",\") // comma-separated string\n  //   }\n  // });\n\n  // Optional: Set a default value\n  // range2.getCell(cursorrow, cursorcol+1).setValue(\"TRUE\");\n  // cursorcol--;\n  // sheet.getCell(cursorrow, cursorcol+1).getFormat().getFill().setColor(\"black\");\n  \n  // sheet.getCell(cursorrow, cursorcol + 2).getFormat().getFill().setColor(\"black\");\n\n\n\n  const range = sheet.getRange(\n    convertToA1(cursorrow, cursorcol) + \":\" + convertToA1(cursorrow + number_of_rows - 1, cursorcol + number_of_cols - 1)\n  );\n\n  const fmt = range.getFormat();\n  const borders = [\n    ExcelScript.BorderIndex.edgeTop,\n  ];\n\n  for (let b of borders) {\n    fmt.getRangeBorder(b).setStyle(ExcelScript.BorderLineStyle.dash);\n  }\n\n  // fmt.getFill().setColor(color);\n\n  return range;\n}\n\n\nfunction doneMessage(\n  blockID: number,\n  sheet: ExcelScript.Worksheet,\n  colID: number\n){\n  const rowID = blockID+1;\n  sheet.getCell(rowID, colID).setValue(\"âœ“\");\n\n}\n\nfunction fullCompleteMessage(\n  sheet: ExcelScript.Worksheet,\n  rowID: number,\n  colID: number\n){\n  sheet.getCell(rowID, colID).setValue(\"ðŸ‘‡ Check ABH sheet.\");\n  sheet.getCell(rowID, colID).getFormat().getFont().setColor(\"gray\");\n  sheet.getCell(rowID, colID).getFormat().getFont().setName(\"Ink Free\");\n  sheet.getCell(rowID, colID).getFormat().getFont().setSize(8);\n  sheet.getCell(rowID, colID).getFormat().getFont().setBold(true);\n\n\n}\n\n\nfunction lookUp(){\n\n  const lookup: { [key: string]: [number, number, number] } = {}; \n\n  lookup[\"A\"] = [0.082, 0.078, 4.338];\n  lookup[\"B\"] = [0.015, 0.02, 2.849];\n  lookup[\"C\"] = [0.028, 0.04, 2.849];\n  lookup[\"D\"] = [0.043, 0.038, 2.964];\n  lookup[\"E\"] = [0.127, 0.11, 3.383];\n  lookup[\"F\"] = [0.022, 0.014, 2.612];\n  lookup[\"G\"] = [0.02, 0.03, 2.494];\n  lookup[\"H\"] = [0.061, 0.023, 2.612];\n  lookup[\"I\"] = [0.07, 0.086, 3.383];\n  lookup[\"J\"] = [0.0015, 0.0021, 2.964];\n  lookup[\"K\"] = [0.0077, 0.0097, 3.545];\n  lookup[\"L\"] = [0.04, 0.053, 4.338];\n  lookup[\"M\"] = [0.024, 0.027, 3.772];\n  lookup[\"N\"] = [0.067, 0.072, 3.196];\n  lookup[\"O\"] = [0.075, 0.061, 4.043];\n  lookup[\"P\"] = [0.019, 0.028, 4.889];\n  lookup[\"Q\"] = [0.00095, 0.0019, 4.889];\n  lookup[\"R\"] = [0.06, 0.073, 2.934];\n  lookup[\"S\"] = [0.063, 0.087, 3.545];\n  lookup[\"T\"] = [0.091, 0.067, 2.707];\n  lookup[\"U\"] = [0.028, 0.033, 2.934];\n  lookup[\"V\"] = [0.0098, 0.01, 2.732];\n  lookup[\"W\"] = [0.024, 0.0091, 4.043];\n  lookup[\"X\"] = [0.0015, 0.0027, 3.196];\n  lookup[\"Y\"] = [0.02, 0.016, 2.707];\n  lookup[\"Z\"] = [0.00074, 0.0044, 3.772];\n\n  return lookup;\n  \n  }\n\n  function dropDown(\n    // sheet: ExcelScript.Worksheet,\n    range: ExcelScript.Range,\n    rowID: number,\n    colID: number\n  ){\n\n    // const sheet = workbook.getActiveWorksheet();\n\n    // Target cell or range\n    // const range = sheet.getRange(\"A1:A10\");\n\n    // Define dropdown options\n    const options = [\"TRUE\", \"FALSE\"];\n\n    // Apply data validation\n    const validation = range.getDataValidation();\n    validation.setRule({\n      list: {\n        inCellDropDown: true,\n        source: options.join(\",\") // comma-separated string\n      }\n    });\n\n    // Optional: Set a default value\n    range.getCell(rowID, colID).setValue(\"TRUE\");\n\n  }\n\nfunction writeCode(\n  sheet: ExcelScript.Worksheet,\n  // range: ExcelScript.Range,\n  // input_var_name: string,\n  cursorrow: number,\n  cursorcol: number,\n  number_of_rows: number,\n  number_of_cols: number\n  ) {\n  // Get the active worksheet\n  // let sheet = workbook.getActiveWorksheet();\n\n  // Change this to your range\n  // let range = sheet.getRange(\"A1:G1\"); // assuming numbers are in row 1, columns A to G\n  const range = sheet.getRangeByIndexes(cursorrow, cursorcol, number_of_rows, number_of_cols);\n  // Get values from the range\n  let values = range.getValues()[0]; // [0] for the first row\n\n  let numbersStr = values.map(v => v.toString()).join(\", \");\n\n  let resultStr = `X = torch.tensor([${numbersStr}])`;\n\n  // Output to immediate cell (you can change location)\n  // sheet.getCell(2, 0).setValue(resultStr); // outputs in A3\n  console.log(resultStr);\n}\n\nfunction getCode(\n  // sheet: ExcelScript.Worksheet,\n  range: ExcelScript.Range,\n  input_var_name: string,\n  output_var_name: string,\n  cursorrow: number,\n  cursorcol: number,\n  number_of_rows: number,\n  number_of_cols: number\n) {\n  // Get the active worksheet\n  // let sheet = workbook.getActiveWorksheet();\n\n  // Change this to your range\n  // let range = sheet.getRange(\"A1:G1\"); // assuming numbers are in row 1, columns A to G\n  // const range = sheet.getRangeByIndexes(cursorrow, cursorcol, number_of_rows, number_of_cols);\n  // Get values from the range\n  let values = range.getValues()[0]; // [0] for the first row\n\n  let numbersStr = values.map(v => v.toString()).join(\", \");\n\n  let resultStr = `${output_var_name} = torch.tensor([${numbersStr}])`;\n\n  // Output to immediate cell (you can change location)\n  // sheet.getCell(2, 0).setValue(resultStr); // outputs in A3\n  // console.log(resultStr);\n  return resultStr;\n}\n\n// function writeCodetoCell(\n//   sheet: ExcelScript.Worksheet,\n//   header: string,\n//   extractedString: string,\n//   cursorrow: number,\n//   cursorcol: number,\n//   number_of_rows: number,\n//   number_of_cols: number\n// ){\n//   // sheet.getCell(cursorrow, cursorcol).setValue(header);\n//   sheet.getCell(cursorrow, cursorcol).getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.left);\n\n//   cursorrow += 1;\n\n//   const charCount = extractedString.length;\n\n//   for (let i = 0; i < charCount; i++) {\n//     const cell = sheet.getCell(cursorrow, cursorcol + i); // zero-indexed\n//     cell.setValue(extractedString[i]);\n//   }\n//   const range2 = doFormatting(sheet, cursorrow, cursorcol, number_of_rows, number_of_cols, \"#f6b26b\");\n//   cursorrow += number_of_rows + 1;\n\n//   sheet.getCell(cursorrow, cursorcol).setValue(\"Token ID\")\n//   sheet.getCell(cursorrow, cursorcol).getFormat().setHorizontalAlignment(ExcelScript.HorizontalAlignment.left);\n//   cursorrow += 1;\n//   const formula_ = `=CODE(LOWER(${range2.getAddress()}))- CODE(\"a\")`;\n//   sheet\n//     .getCell(cursorrow, cursorcol)\n//     .setFormula(formula_);\n//   const range = doFormatting(sheet, cursorrow, cursorcol, number_of_rows, number_of_cols, \"white\");\n//   cursorrow += number_of_rows + 1;\n//   // return { row: cursorrow, col: cursorcol, range }\n// }","description":"","noCodeMetadata":"","parameterInfo":"{\"version\":1,\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{}},\"signature\":{\"comment\":\"\",\"parameters\":[{\"name\":\"workbook\",\"comment\":\"\"}]}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}